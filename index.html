<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minsu GPT</title>
<style>
/* ... (ê¸°ì¡´ CSS ì½”ë“œ ìœ ì§€) ... */
:root {
Â  --bg: #ffffff;
Â  --text: #111;
Â  --input-bg: #f7f7f8;
Â  --border: #dcdcdc;
Â  --border-strong: #b0b0b0;
Â  --button-bg: #000;
Â  --button-text: #fff;
Â  --menu-bg: rgba(255,255,255,0.95);
Â  --menu-text: #444;
Â  --transition: 0.3s ease;
Â  --code-bg: #f0f0f0; /* ì½”ë“œ ë¸”ë¡ ë°°ê²½ìƒ‰ (ë°ì€ ëª¨ë“œ) */
}
body.dark {
Â  --bg: #0d0d0d;
Â  --text: #e4e4e4;
Â  --input-bg: #1a1a1a;
Â  --border: #2a2a2a;
Â  --border-strong: #555;
Â  --button-bg: #fff;
Â  --button-text: #000;
Â  --menu-bg: rgba(30,30,30,0.9);
Â  --menu-text: #ccc;
Â  --code-bg: #2b2b2b; /* ì½”ë“œ ë¸”ë¡ ë°°ê²½ìƒ‰ (ë‹¤í¬ ëª¨ë“œ) */
}
* { box-sizing: border-box; transition: background var(--transition), color var(--transition), border var(--transition); }
body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
nav { position: fixed; top: 0; left: 0; width: 100%; height: 60px; background: var(--bg); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; padding: 0.6rem 1.2rem; z-index: 10; }
.logo { font-weight: 600; font-size: 1.05rem; }
.actions { display: flex; gap: 10px; align-items: center; }
.actions button { border-radius: 20px; font-size: 0.9rem; padding: 0.4rem 1rem; cursor: pointer; }
.login { background: var(--button-bg); color: var(--button-text); border: none; }
.signup { background: transparent; border: 1px solid var(--border); color: var(--text); }
.darkmode-toggle { background: transparent; border: 1px solid var(--border); border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: var(--text); }
main { flex: 1; padding: 60px 1rem 120px; overflow-y: auto; scroll-behavior: smooth; display: flex; flex-direction: column; align-items: center; }
#title { font-size: 1.8rem; font-weight: 600; text-align: center; margin-top: 12rem; transition: opacity 0.5s ease; }
.suggestions {
Â  display: grid;
Â  grid-template-columns: repeat(4, 1fr);
Â  gap: 0.8rem;
Â  width: 100%;
Â  max-width: 700px;
Â  margin-top: 3rem;
Â  transition: opacity 0.6s ease, transform 0.6s ease;
}
.suggestion-card { background: var(--input-bg); border: 1px solid var(--border); border-radius: 14px; padding: 1rem; cursor: pointer; text-align: left; transition: all 0.2s ease; }
.suggestion-card:hover { border-color: var(--border-strong); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
.messages { display: flex; flex-direction: column; gap: 0.8rem; width: 100%; max-width: 700px; margin-top: 2rem; }
.message { max-width: 80%; padding: 0.7rem 1rem; border-radius: 16px; word-break: break-word; white-space: pre-wrap; position: relative; animation: fadeIn 0.3s ease forwards; font-size: 1rem; }
/* ğŸŒŸ ì‚¬ìš©ì ë©”ì‹œì§€: ë³¼ë“œì²´ ì œê±° */
.message.user { 
Â  background: var(--button-bg); 
Â  color: var(--button-text); 
Â  align-self: flex-end; 
Â  font-weight: normal; /* ë³¼ë“œì²´ ì œê±° */
}
/* ë´‡ ë©”ì‹œì§€ */
.message.bot { 
Â  background: var(--input-bg); 
Â  border: 1px solid var(--border); 
Â  align-self: flex-start; 
Â  font-size: 1rem; 
}

/* ğŸŒŸ ë§ˆí¬ë‹¤ìš´ ìŠ¤íƒ€ì¼ ì¶”ê°€ ğŸŒŸ */
.message.bot ul,
.message.bot ol {
Â  padding-left: 20px;
Â  margin: 0.5rem 0;
}
.message.bot li {
Â  margin-bottom: 0.2rem;
}
.message.bot p {
Â  margin: 0.5rem 0;
}
.message.bot strong {
Â  font-weight: 700;
}
.message.bot em {
Â  font-style: italic;
}
.message.bot blockquote {
Â  border-left: 4px solid var(--border-strong);
Â  padding-left: 10px;
Â  color: var(--menu-text);
Â  margin: 0.5rem 0;
}
/* ğŸŒŸ ì¸ë¼ì¸ ì½”ë“œ ìŠ¤íƒ€ì¼ ìœ ì§€ */
.message.bot code:not(pre code) {
Â  background: var(--border);
Â  padding: 2px 4px;
Â  border-radius: 4px;
Â  font-size: 0.95em;
Â  font-family: monospace;
}
/* ğŸŒŸ ì½”ë“œ ë¸”ë¡ (pre) ìŠ¤íƒ€ì¼ ë° ë³µì‚¬ ë²„íŠ¼ ğŸŒŸ */
.message.bot pre {
Â  background: var(--code-bg);
Â  padding: 0; /* paddingì„ 0ìœ¼ë¡œ ì„¤ì •í•˜ê³  headerì™€ codeì—ì„œ íŒ¨ë”© ì²˜ë¦¬ */
Â  border-radius: 6px;
Â  overflow: hidden;
Â  margin: 1rem 0; /* ë©”ì‹œì§€ ë²„ë¸” ë‚´ ì—¬ë°± */
Â  position: relative;
}
.code-header {
Â  background: var(--border);
Â  color: var(--text);
Â  padding: 0.3rem 0.8rem;
Â  font-size: 0.85em;
Â  display: flex;
Â  justify-content: flex-end;
Â  align-items: center;
}
.code-header .copy-btn {
Â  background: var(--button-bg);
Â  color: var(--button-text);
Â  border: none;
Â  padding: 4px 10px;
Â  border-radius: 4px;
Â  cursor: pointer;
Â  font-size: 0.85em;
Â  transition: opacity 0.2s;
}
.code-header .copy-btn:hover { opacity: 0.8; }
.code-header .copy-btn.copied {
Â  background: #4CAF50; /* ë³µì‚¬ ì™„ë£Œ ìƒ‰ìƒ */
Â  color: #fff;
}
.message.bot pre code {
Â  display: block;
Â  padding: 1rem;
Â  overflow-x: auto;
Â  font-family: monospace;
Â  font-size: 0.95rem;
Â  line-height: 1.4;
Â  /* êµ¬ë¬¸ ê°•ì¡° ëª¨ë°© */
Â  color: var(--text);
}

@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

/* ğŸŒŸ ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ (ì›ë˜ëŒ€ë¡œ ìœ ì§€) ğŸŒŸ */
.input-bar { 
Â  position: fixed; 
Â  bottom: 0; 
Â  left: 0; 
Â  width: 100%; 
Â  background: linear-gradient(to top, var(--bg) 90%, transparent); 
Â  display: flex; 
Â  justify-content: center; 
Â  padding: 0.6rem 1rem 1rem; 
Â  z-index: 20; 
}
.input-wrapper { 
Â  display: flex; 
Â  align-items: flex-end; 
Â  width: 100%; 
Â  max-width: 700px; 
Â  background: var(--input-bg); 
Â  border-radius: 22px; 
Â  border: 1.5px solid var(--border-strong); 
Â  padding: 0.4rem 0.6rem; 
Â  gap: 0.4rem; 
}
textarea { 
Â  flex: 1; 
Â  border: none; 
Â  background: transparent; 
Â  color: var(--text); 
Â  font-size: 1rem; 
Â  resize: none; 
Â  overflow-y: auto; 
Â  min-height: 1.4rem; 
Â  max-height: 200px; 
Â  line-height: 1.4rem; 
Â  padding: 6px 0; 
Â  outline: none; 
Â  white-space: pre-wrap; 
}
textarea:disabled { opacity: 0.6; cursor: not-allowed; } /* ë¹„í™œì„±í™” ì‹œ ìŠ¤íƒ€ì¼ ì¶”ê°€ */

.btn { 
Â  border: none; 
Â  border-radius: 50%; 
Â  width: 36px; 
Â  height: 36px; 
Â  display: flex; 
Â  align-items: center; 
Â  justify-content: center; 
Â  cursor: pointer; 
Â  background: var(--button-bg); 
Â  color: var(--button-text); 
}
/* ğŸŒŸ ì‘ë‹µ ì¤‘ì§€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
.btn#stopBtn {
Â  background: #f00; /* ì¤‘ì§€ ë²„íŠ¼ì€ ë¹¨ê°„ìƒ‰ */
Â  color: #fff;
Â  font-size: 0.9rem;
Â  width: auto; /* ë„ˆë¹„ ìë™ ì„¤ì • */
Â  height: 36px;
Â  border-radius: 20px;
Â  padding: 0 1rem;
}
/* ğŸŒŸ */

.loading-bar { width: 100%; height: 4px; background: var(--border); overflow: hidden; border-radius: 4px; margin-top: 6px; position: relative; }
.loading-bar::after { content: ""; position: absolute; top: 0; left: -40%; width: 40%; height: 100%; background: var(--button-bg); animation: barMove 1s linear infinite; }
@keyframes barMove { 0% { left: -40%; } 100% { left: 100%; } }

/* ëª¨ë°”ì¼ ëŒ€ì‘ */
@media(max-width:700px){
Â  .suggestions { grid-template-columns: repeat(2, 1fr); }
Â  .message { font-size: 1.1rem; }
}
</style>
</head>
<body>
<nav>
Â  <div class="logo">Minsu GPT</div>
Â  <div class="actions">
Â  Â  <button class="login">ë¡œê·¸ì¸</button>
Â  Â  <button class="signup">ë¬´ë£Œë¡œ íšŒì› ê°€ì…</button>
Â  Â  <button class="darkmode-toggle" id="darkBtn">ğŸŒ™</button>
Â  </div>
</nav>
<main id="main">
Â  <h1 id="title">ì–´ë””ì„œë¶€í„° ì‹œì‘í• ê¹Œìš”?</h1>
Â  <div class="suggestions">
Â  Â  <div class="suggestion-card" data-prompt="ì°½ì˜ì ì¸ ê¸€ì“°ê¸° ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•´ì¤˜">âœï¸ ì°½ì˜ì ì¸ ê¸€ì“°ê¸° ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•´ì¤˜</div>
Â  Â  <div class="suggestion-card" data-prompt="íŒŒì´ì¬ìœ¼ë¡œ ê°„ë‹¨í•œ ê²Œì„ ë§Œë“œëŠ” ë²• ì•Œë ¤ì¤˜">ğŸ® íŒŒì´ì¬ìœ¼ë¡œ ê°„ë‹¨í•œ ê²Œì„ ë§Œë“œëŠ” ë²• ì•Œë ¤ì¤˜</div>
Â  Â  <div class="suggestion-card" data-prompt="íš¨ê³¼ì ì¸ ì‹œê°„ ê´€ë¦¬ ë°©ë²• ì¶”ì²œí•´ì¤˜">â° íš¨ê³¼ì ì¸ ì‹œê°„ ê´€ë¦¬ ë°©ë²• ì¶”ì²œí•´ì¤˜</div>
Â  Â  <div class="suggestion-card" data-prompt="ì¬ë¯¸ìˆëŠ” ê³¼í•™ ì‚¬ì‹¤ ì•Œë ¤ì¤˜">ğŸ”¬ ì¬ë¯¸ìˆëŠ” ê³¼í•™ ì‚¬ì‹¤ ì•Œë ¤ì¤˜</div>
Â  </div>
Â  <div class="messages" id="messages"></div>
</main>
<div class="input-bar">
Â  <div class="input-wrapper">
Â  Â  <button class="btn" id="plusBtn">ï¼‹</button>
Â  Â  <textarea id="userInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." rows="1"></textarea>
Â  Â  <button class="btn" id="sendBtn">â¤</button>
Â  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
const darkBtn = document.getElementById("darkBtn");
const messages = document.getElementById("messages");
const textarea = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const inputWrapper = sendBtn.parentElement; // input-wrapperë¥¼ ì°¾ìŠµë‹ˆë‹¤.
const cards = document.querySelectorAll(".suggestion-card");
const body = document.body;
let loadingMsg = null;

let isResponding = false; // ğŸŒŸ ìƒíƒœ ê´€ë¦¬ ë³€ìˆ˜
let abortController = null; // ğŸŒŸ ìš”ì²­ ì¤‘ì§€ ì»¨íŠ¸ë¡¤ëŸ¬

// ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ ë‹¹ì‹ ì˜ PythonAnywhere ë°±ì—”ë“œ ì£¼ì†Œì…ë‹ˆë‹¤! ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
const BACKEND_URL = 'https://jaewons0227.pythonanywhere.com/ask';
// ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

// ë‹¤í¬ëª¨ë“œ í† ê¸€
darkBtn.addEventListener("click", () => {
Â  body.classList.toggle("dark");
Â  darkBtn.textContent = body.classList.contains("dark") ? "â˜€ï¸" : "ğŸŒ™";
});

// ì¹´ë“œ í´ë¦­
cards.forEach(card => {
Â  card.addEventListener("click", () => {
Â  Â  if (isResponding) return; // ì‘ë‹µ ì¤‘ì´ë©´ ë¬´ì‹œ
Â  Â  textarea.value = card.dataset.prompt;
Â  Â  sendMessage();
Â  });
});

// ğŸŒŸ addMessage í•¨ìˆ˜ ìˆ˜ì • (ë³¼ë“œì²´ ì œê±°ë¥¼ ìœ„í•´ font-weight: normalì„ CSSì— ì ìš©)
function addMessage(role, text) { 
Â  const msg = document.createElement("div");
Â  msg.className = `message ${role}`;
Â  msg.textContent = text;
Â  messages.appendChild(msg);
Â  messages.scrollTop = messages.scrollHeight;
}

function addLoadingBubble(){
Â  const msg = document.createElement("div");
Â  msg.className = "message bot bot-loading";
Â  msg.innerHTML = "<div>ìƒê° ì¤‘...</div><div class='loading-bar'></div>";
Â  messages.appendChild(msg);
Â  messages.scrollTop = messages.scrollHeight;
Â  loadingMsg = msg;
}

// ğŸŒŸ ì½”ë“œ ë³µì‚¬ ê¸°ëŠ¥ ì¶”ê°€
function attachCopyFunctionality(element) {
Â  element.querySelectorAll('pre code').forEach(codeBlock => {
Â  Â  const pre = codeBlock.closest('pre');
Â  Â  
Â  Â  // 1. í—¤ë” ìƒì„±
Â  Â  const header = document.createElement('div');
Â  Â  header.className = 'code-header';

Â  Â  // 2. ë³µì‚¬ ë²„íŠ¼ ìƒì„±
Â  Â  const copyBtn = document.createElement('button');
Â  Â  copyBtn.className = 'copy-btn';
Â  Â  copyBtn.textContent = 'ë³µì‚¬';

Â  Â  // 3. ë³µì‚¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
Â  Â  copyBtn.addEventListener('click', () => {
Â  Â  Â  navigator.clipboard.writeText(codeBlock.textContent).then(() => {
Â  Â  Â  Â  const originalText = copyBtn.textContent;
Â  Â  Â  Â  copyBtn.textContent = 'ë³µì‚¬ ì™„ë£Œ!';
Â  Â  Â  Â  copyBtn.classList.add('copied');
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  copyBtn.textContent = originalText;
Â  Â  Â  Â  Â  copyBtn.classList.remove('copied');
Â  Â  Â  Â  }, 2000);
Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
Â  Â  Â  Â  alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
Â  Â  Â  });
Â  Â  });

Â  Â  header.appendChild(copyBtn);
Â  Â  pre.prepend(header); // pre ìš”ì†Œì˜ ë§¨ ì•ì— í—¤ë”ë¥¼ ì‚½ì…
Â  });
}


// ğŸŒŸ replaceLoadingBubble í•¨ìˆ˜ ìˆ˜ì • (marked.js ë° ë³µì‚¬ ê¸°ëŠ¥ ì ìš©)
function replaceLoadingBubble(text){
Â  if(loadingMsg){
Â  Â  loadingMsg.classList.remove("bot-loading");
Â  Â  
Â  Â  // marked.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ˆí¬ë‹¤ìš´ì„ HTMLë¡œ ë³€í™˜
Â  Â  const htmlContent = marked.parse(text);

Â  Â  loadingMsg.innerHTML = htmlContent;
Â  Â  
Â  Â  // ë³µì‚¬ ê¸°ëŠ¥ ì¶”ê°€ í˜¸ì¶œ
Â  Â  attachCopyFunctionality(loadingMsg);

Â  Â  loadingMsg = null;
Â  Â  messages.scrollTop = messages.scrollHeight;
Â  }
}


// ğŸŒŸ UI ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
function updateUI(loading) {
Â  isResponding = loading;
Â  textarea.disabled = loading;
Â  
Â  if (loading) {
Â  Â  // ì‘ë‹µ ì¤‘ì´ë©´ ì „ì†¡ ë²„íŠ¼ì„ ì œê±°í•˜ê³  ì¤‘ì§€ ë²„íŠ¼ì„ ì¶”ê°€
Â  Â  sendBtn.style.display = 'none';

Â  Â  const stopBtn = document.createElement('button');
Â  Â  stopBtn.className = 'btn';
Â  Â  stopBtn.id = 'stopBtn';
Â  Â  stopBtn.textContent = 'âŒ ì‘ë‹µ ì¤‘ì§€';
Â  Â  
Â  Â  stopBtn.addEventListener('click', stopResponse);
Â  Â  inputWrapper.appendChild(stopBtn);
Â  } else {
Â  Â  // ì‘ë‹µì´ ëë‚˜ë©´ ì¤‘ì§€ ë²„íŠ¼ì„ ì œê±°í•˜ê³  ì „ì†¡ ë²„íŠ¼ì„ í‘œì‹œ
Â  Â  const stopBtn = document.getElementById('stopBtn');
Â  Â  if (stopBtn) {
Â  Â  Â  inputWrapper.removeChild(stopBtn);
Â  Â  }
Â  Â  sendBtn.style.display = 'flex';
Â  Â  abortController = null;
Â  }
}

// ğŸŒŸ ì‘ë‹µ ì¤‘ì§€ í•¨ìˆ˜
function stopResponse() {
Â  if (abortController) {
Â  Â  abortController.abort();
Â  Â  replaceLoadingBubble("âš ï¸ ì‘ë‹µì´ ì‚¬ìš©ì ìš”ì²­ì— ì˜í•´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.");
Â  Â  updateUI(false);
Â  }
}


// ë©”ì‹œì§€ ì „ì†¡
async function sendMessage(){
Â  if (isResponding) return; // ì‘ë‹µ ì¤‘ì´ë©´ ì „ì†¡í•˜ì§€ ì•ŠìŒ

Â  const text = textarea.value.trim();
Â  if(!text) return;
Â  
Â  textarea.value="";
Â  addMessage("user", text);
Â  addLoadingBubble();
Â  updateUI(true); // ğŸŒŸ ë¡œë”© ìƒíƒœë¡œ ë³€ê²½ ë° UI ì—…ë°ì´íŠ¸
Â  
Â  abortController = new AbortController();
Â  const signal = abortController.signal;

Â  try{
Â  Â  const res = await fetch(BACKEND_URL, {
Â  Â  Â  method:"POST",
Â  Â  Â  headers: {"Content-Type":"application/json"},
Â  Â  Â  body: JSON.stringify({message:text}),
Â  Â  Â  signal: signal // ğŸŒŸ ì¤‘ì§€ ì‹ í˜¸ ì¶”ê°€
Â  Â  });

Â  Â  if (res.status === 200) {
Â  Â  Â  const data = await res.json();
Â  Â  Â  replaceLoadingBubble(data.reply);
Â  Â  } else {
Â  Â  Â  throw new Error(`ì„œë²„ ì˜¤ë¥˜: ${res.status}`);
Â  Â  }
Â  Â  
Â  } catch(e){
Â  Â  if (e.name !== 'AbortError') { // ì‚¬ìš©ìê°€ ì¤‘ì§€í•œ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ì˜¤ë¥˜ ì²˜ë¦¬
Â  Â  Â  replaceLoadingBubble("âš ï¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.message);
Â  Â  }
Â  } finally {
Â  Â  // ì‘ë‹µ ì™„ë£Œ í›„ ë¡œë”© ìƒíƒœ í•´ì œ ë° UI ì—…ë°ì´íŠ¸
Â  Â  if (isResponding) {
Â  Â  Â  updateUI(false); 
Â  Â  }
Â  }
}

sendBtn.addEventListener("click", sendMessage);
textarea.addEventListener("keydown", e=>{
Â  if(e.key==="Enter" && !e.shiftKey){
Â  Â  e.preventDefault();
Â  Â  sendMessage();
Â  }
});

textarea.addEventListener("input", ()=>{
Â  textarea.style.height="auto";
Â  textarea.style.height = textarea.scrollHeight + "px";
});
</script>
</body>
</html>
